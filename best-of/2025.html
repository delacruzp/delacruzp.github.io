<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Best Of 2025 | Portfolio</title>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --bg-color: #0a0a0a;
            --text-color: #ffffff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            /* Prevent body bounce/overscroll on mobile */
            overscroll-behavior-y: none;
        }

        .font-serif {
            font-family: 'Playfair Display', serif;
        }

        .hero-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0.0), rgba(0, 0, 0, 0.0) 80%, rgba(0, 0, 0, 0.8)),
                url('/img/2025-f1.jpg');
            background-size: cover;
            background-position: center;
            transition: transform 1.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* Alternate hero for gallery view */
        .hero-bg.gallery {
            background-image: url('/img/2025-f2.jpg');
        }

        .nav-pill {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 100px;
            padding: 6px;
            transition: background 0.4s ease, border-color 0.4s ease;
        }

        .item-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1px;
            background-color: rgba(255, 255, 255, 0.0);
        }

        @media (min-width: 768px) {
            .item-grid {
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
                gap: 2px;
            }
        }

        .grid-item {
            position: relative;
            aspect-ratio: 3/5;
            overflow: hidden;
            background-color: var(--bg-color);
        }

        @media (min-width: 768px) {
            .grid-item {
                aspect-ratio: 4/5;
            }
        }

        .grid-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 1s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.5s ease;
            opacity: 0.7;
        }

        .grid-item:hover img {
            transform: scale(1.05);
            opacity: 1;
        }

        .grid-item-info {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 1.5rem 1rem 1rem 1rem;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.4) 70%, transparent 100%);
        }

        @media (min-width: 768px) {
            .grid-item-info {
                padding: 2rem;
                opacity: 0;
                transform: translateY(10px);
                transition: all 0.4s ease;
            }

            .grid-item:hover .grid-item-info {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Entry & Exit Animations */
        .slide-from-left {
            animation: slideFromLeft 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .slide-from-right {
            animation: slideFromRight 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        /* Exits swipe in the opposite direction */
        .exit-to-right {
            animation: exitToRight 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .exit-to-left {
            animation: exitToLeft 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes slideFromLeft {
            from {
                transform: translateX(-100vw);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideFromRight {
            from {
                transform: translateX(100vw);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes exitToRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(100vw);
                opacity: 0;
            }
        }

        @keyframes exitToLeft {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(-100vw);
                opacity: 0;
            }
        }

        /* Container to keep exiting and entering grids positioned correctly */
        .gallery-container {
            position: relative;
            width: 100%;
            overflow: visible;
        }

        /* Review Formatting */
        .review-content p {
            margin-bottom: 1.5rem;
        }

        .review-content ul {
            list-style-type: none;
            padding: 0;
            margin-bottom: 2rem;
        }

        .review-content li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.75rem;
            text-align: left;
        }

        .review-content li::before {
            content: "—";
            position: absolute;
            left: 0;
            opacity: 0.5;
        }

        /* Iframe loading spinner */
        .spinner-overlay {
            position: relative;
            width: 100%;
            height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.45);
            border-radius: 12px;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(255, 255, 255, 0.15);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .title-clamp {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Text-only treatment for landing title and lead */
        .landing-title {
            color: #fff;
            -webkit-text-stroke: 0.6px rgba(0,0,0,0.65);
            text-shadow: 0 8px 30px rgba(0,0,0,0.65), 0 1px 0 rgba(255,255,255,0.02);
            line-height: 0.88;
        }

        .landing-lead {
            color: rgba(255,255,255,0.92);
            text-shadow: 0 4px 18px rgba(0,0,0,0.45);
        }
    </style>
</head>

<body class="bg-black">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo, useRef } = React;

        const CATEGORIES = [
            { id: 'movies', label: 'Cinema', titleLabel: 'Best Movies', brand: 'Letterboxd' },
            { id: 'books', label: 'Literature', titleLabel: 'Best Books', brand: 'Goodreads' },
            { id: 'essays', label: 'Essays', titleLabel: 'Best Essays', brand: 'NY Times' },
            { id: 'songs', label: 'Music', titleLabel: 'Best Songs', brand: 'Spotify' },
        ];

        const INITIAL_DATA = {
            movies: [
                {
                    id: 'm1',
                    title: "A Nice Indian Boy",
                    year: "Cinema",
                    rating: 5,
                    url: "https://letterboxd.com/delacruzp/film/a-nice-indian-boy/",
                    image: "/img/2025-m1.png",
                    review: `I was laughing out loud through out this entire movie. The only moments when I was not laughing it was, because I was aggressively sobbing.

I must admit I was apprehensive going into this movie. But everything about it was SO f-ing good. Every single joke landed, my entire movie theater was enjoying the movie, which made the whole experience that more enjoyable.

I think it's my first time watching a movie, where the relationship with the parents it's not a zero sum game. It's not all in, neither all out. It's hard, complicated, awkward and at time sad, and still they keep trying to make it work.

I loved the splitting the movie into chapters. Love the way it tell the stories. Both the cutaways from the date, to the discussion of the date, and back. The sister narration. Ugh I love this movie.

Scenes where I cried:
• Naveen saying that of course he wants a wedding and love, and all the nice things.
• The mom saying that she was scared to say the wrong thing, and lose her kid forever.
• The dad saying that his kid has good taste.`,
                    quotes: [
                        "Are you waiting for a big speech to make you stay? Cuz I wont have one.",
                        "I know, I'm the dramatic one.",
                        "I don't want to hear sweeping notions of love. It's 2024, the world is burning!",
                        "We think it's wonderful that you're White.",
                    ]
                },
                {
                    id: 'm2',
                    title: "Tetris",
                    year: "Cinema",
                    rating: 4.5,
                    url: "https://letterboxd.com/delacruzp/film/tetris/",
                    image: "/img/2025-m2.png",
                    review: `This movie fucking slaps.

Who knew watching suits do capitalism could be that entertaining. 

Now let me go and play some tetris.`},
                {
                    id: 'm3',
                    title: "Sorry, Baby",
                    year: "Cinema",
                    rating: 4.5,
                    url: "https://letterboxd.com/delacruzp/film/sorry-baby-2025/",
                    image: "/img/2025-m3.png",
                    review: `I really enjoyed this.

Granted my expectations going into it where on the floor, but hey apparently that's the key to loving a movie.

Things I loved:
• The cinematography
• The shot of them seating by the beach, with the afro backlit, and glowing like a halo.
• The shot of the snow falling thorugh the window.
• The Jokes
• My dad is divorced.
• Are you safe, in your home? Yes. I have a cat.
• I'm gay, who would have guessed?
Honestly, too many to list. Which is why I loved this.
• The Plot
• The sandwich scene.
• The doctor asking questions without a tonal shift.
• The baby scene.
• The Acting

Dude. I just loved this movie. Bye.` },
                {
                    id: 'm4',
                    title: "Bugonia",
                    year: "Cinema",
                    rating: 4, url: "https://letterboxd.com/delacruzp/film/bugonia/",
                    image: "/img/2025-m4.png",
                    review: "Can you diversify, the words, of the diversity training?"
                },
                {
                    id: 'm5',
                    title: "Eddington",
                    year: "Cinema",
                    rating: 4,
                    url: "https://letterboxd.com/delacruzp/film/eddington/",
                    image: "/img/2025-m5.png",
                    review: "So much could have been avoided if people were just nicer to each other."
                }
            ],
            books: [
                {
                    id: 'b1',
                    title: "Giovanni’s Room",
                    year: "Literature",
                    rating: 5,
                    url: "https://www.goodreads.com/",
                    image: "/img/2025-b1.png",
                    quotes: [
                        "Soon, it was too late to do anything but moan.",
                        "Maybe everything bad that happens to you makes you weaker... so you can stand less and less.",
                        "You will go home and then you will find that home is not home anymore. Then you will really be in trouble. As long as you stay here, you can always think: One day I will go home.",
                        "It is cruel to have made me want to live only to make my death more bloody.",
                        "You want to leave Giovanni because he makes you stink. You want to despise Giovanni because he is not afraid of the stink of love. You want to kill him in the name of all your lying little moralities. And you—you are immoral. You are, by far, the most immoral man I have met in all my life. Look, look what you have done to me.",
                        "Be careful. Please be careful. He gave me an ironical smile. ‘Thank you’, he said, 'You should have given me that advice the night we met”",
                        "What's the good of an American who isn't happy? Happiness was all we had.",
                    ]
                },
                {
                    id: 'b2',
                    title: "A Little Daylight Left: Poems",
                    year: "2025",
                    rating: 4,
                    url: "https://www.goodreads.com/book/show/215805885-a-little-daylight-left",
                    image: "/img/2025-b2.webp",
                },
                {
                    id: 'b3',
                    title: "The Seven Moons of Maali Almeida",
                    year: "2022",
                    rating: 4,
                    url: "https://www.goodreads.com/book/show/57224204-the-seven-moons-of-maali-almeida",
                    image: "/img/2025-b3.png",
                    review: `A difficult read, worth the effort, like all best things.

I forgot how much I love a well thought-out story. A perfect ending is one of the few joys of life.

This booked pushed me, in more ways than one. I got to learned about the Sri Lanka civil war, the racial conflicts in the other side of the world, names that my tongue struggles to pronounced and stories that although noveled, brought up familiar emotions.

At the end of the day, the world keeps spinning, our efforts have a limited impact, our actions hurt our loved ones, but life is definitely not nothing.

New Word:
- Frock


Quotes that made me smile:
- That women has children to feed. That man has hospital to runs.You take photos, how impressive.
- His head is not between his shoulders, as heads prefer to be.
- I'm not your helper, sir. I only helped those that help me... -- You sound like the UN.
- Usually when you brought women home, which was about as frequent as free and fair elections...

Favorite Paragraphs:
- "Once you have seen your own face, and recognised the coulour of your eyes, tasted the air and smelled the soil, drunk from the purest fountains and the dirties wells, that is the kindest thing you can say about life, It's not nothing."
- " And right then with the moon in the sky, you realize you have nothing left to tell and no one to tell it to. You recognize this as a simple fact and are neither dismayed nor gladedened.
`,
                    quotes: [
                        "- Despair always begins as a snack that you nibble on when bored and then becomes a meal that you have thrice a day.",
                        "- That is the kindest thing you can say about life, It's not nothing.",
                        "- Let's go to San Francisco and make money and love and let this shit country burn to the ground.",
                        "- He was handsome and stout just the way you liked them, though you liked them many ways.",
                        "- The one good thing you can say about a bomb is that it isn't racist or sexist or concerned about class.",
                        "- Because a blow job isn't sex and it isn't sex if you don't see the other person's face and it doesn't count if you were thinking about him during it",
                        "- Two promises are worth less than one.",
                        "- Three promises are worth less than two.",
                        "- We must all find pointless causes to live for, or why bother with breath?",
                        "- How much money do you make? – I make what all the world's millionaires do not... What is that? – Enough.",
                        "- We have fucked it up. All by ourselves.",
                        "- She stares out the window and let water spills from her eyes. First a drop, then an eye full, then a fountain.",
                    ]
                },
                {
                    id: 'b4',
                    title: "Everything Is Tuberculosis: The History and Persistence of Our Deadliest Infection",
                    year: "2025",
                    rating: 4,
                    url: "https://www.goodreads.com/book/show/220341389-everything-is-tuberculosis",
                    image: "/img/2025-b4.jpg",
                }
            ],
            essays: [
                {
                    id: 'e1',
                    title: "The Goon Squad",
                    year: "Nov, 2025",
                    author: "Daniel Kolitz",
                    // rating: 4, 
                    url: "https://harpers.org/archive/2025/11/the-goon-squad-daniel-kolitz-porn-masturbation-loneliness/",
                    image: "/img/2025-e1.webp",
                    site: "Harpers",
                    review: "Loneliness, porn’s next frontier, and the dream of endless masturbation."
                },
                {
                    id: 'e2',
                    title: "We’ve Reached Peak Gay Sluttiness",
                    year: "Aug 29, 2025",
                    author: "Steven Phillips-Horst",
                    url: "https://www.thecut.com/article/ghb-doxypep-sniffies-peak-gay-sluttiness-era-nyc.html",
                    image: "/img/2025-e2.webp",
                    site: "The Cut",
                    review: "Party all weekend, hook up with anyone, never get an STD — or even a hangover. Who says nobody’s having sex anymore?"
                },
                {
                    id: 'e3',
                    title: "She Wanted to Save the World From A.I. Then the Killings Started.",
                    year: "Jul 6, 2025",
                    author: "Christopher Beam",
                    url: "https://www.nytimes.com/2025/07/06/business/ziz-lasota-zizians-rationalists.html?smid=nytcore-android-share",
                    image: "/img/2025-e3.webp",
                    site: "NY Times",
                    review: "At first, Ziz LaSota seemed much like any other philosophically inclined young tech aspirant. Now, she and her followers are in jail, six people are dead, and Rationalists are examining whether their ideas played a role."
                },
                {
                    id: 'e4',
                    title: "We Bought a 450-Pound Mystery Pallet Packed With Returned Goods From Amazon and Beyond. Here’s What We Found Inside.",
                    year: "Nov 17, 2025",
                    author: "Annemarie Conte",
                    url: "https://www.nytimes.com/wirecutter/reviews/mystery-amazon-pallet-unboxing/",
                    image: "/img/2025-e4.webp",
                    site: "Wirecutter",
                }
            ],
            songs: [],
            podcasts: [
                {
                    id: 'p1', title: "The Daily",
                    year: "Podcast",
                    rating: 5, url: "https://open.spotify.com/",
                    image: "https://images.unsplash.com/photo-1590602847861-f357a9332bbc?auto=format&fit=crop&q=80&w=1000",
                    review: "The standard for journalism. Their 2025 series on energy was particularly brilliant."
                }
            ]
        };

        const Icons = {
            home: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" /><polyline points="9 22 9 12 15 12 15 22" /></svg>,
            movies: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="2" width="20" height="20" rx="2" /><line x1="7" y1="2" x2="7" y2="22" /><line x1="17" y1="2" x2="17" y2="22" /><line x1="2" y1="12" x2="22" y2="12" /></svg>,
            books: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" /><path d="M6.5 20V2h11v18a2 2 0 0 0 2-2V2" /></svg>,
            essays: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" /><polyline points="14 2 14 8 20 8" /></svg>,
            songs: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 18V5l12-2v13" /><circle cx="6" cy="18" r="3" /><circle cx="18" cy="16" r="3" /></svg>,
            podcasts: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" /><path d="M19 10v1a7 7 0 0 1-14 0v-1" /></svg>
        };

        const allItemsList = CATEGORIES.flatMap(cat =>
            (INITIAL_DATA[cat.id] || []).map(item => ({ ...item, categoryId: cat.id }))
        );

        const App = () => {
            const getParsedHash = useCallback(() => {
                const hash = window.location.hash.replace(/^#\/?/, '');
                if (!hash) return { view: 'landing', activeCategory: null, selectedId: null };
                const parts = hash.split('/');
                const catId = parts[0];
                const itemId = parts[1];

                const category = CATEGORIES.find(c => c.id === catId);
                if (category) {
                    const item = allItemsList.find(i => i.id === itemId);
                    return {
                        view: 'gallery',
                        activeCategory: category.id,
                        selectedId: item ? item.id : null
                    };
                }
                return { view: 'landing', activeCategory: null, selectedId: null };
            }, []);

            const initial = getParsedHash();

            const [view, setView] = useState(initial.view);
            const [activeCategory, setActiveCategory] = useState(initial.activeCategory);
            const [exitingCategory, setExitingCategory] = useState(null);
            const [selectedId, setSelectedId] = useState(initial.selectedId);
            const [iframeLoaded, setIframeLoaded] = useState(false);
            const [slideDirection, setSlideDirection] = useState('right');

            const allItems = useMemo(() => allItemsList, []);

            const currentIndex = useMemo(() =>
                allItems.findIndex(item => item.id === selectedId),
                [selectedId, allItems]);

            const selectedItem = allItems[currentIndex] || null;

            // Sync state to hash
            useEffect(() => {
                let newHash = '/';
                if (view === 'landing') {
                    newHash = '/';
                } else if (activeCategory) {
                    newHash += activeCategory;
                    if (selectedId) {
                        newHash += '/' + selectedId;
                    }
                }
                if (window.location.hash !== '#' + newHash) {
                    window.location.hash = newHash;
                }
            }, [view, activeCategory, selectedId]);

            // Sync hash to state (back button)
            useEffect(() => {
                const handleHashChange = () => {
                    const parsed = getParsedHash();
                    if (parsed.view !== view) setView(parsed.view);
                    if (parsed.activeCategory !== activeCategory) setActiveCategory(parsed.activeCategory);
                    if (parsed.selectedId !== selectedId) setSelectedId(parsed.selectedId);
                };
                window.addEventListener('hashchange', handleHashChange);
                return () => window.removeEventListener('hashchange', handleHashChange);
            }, [getParsedHash, view, activeCategory, selectedId]);

            const navigateTo = useCallback((index) => {
                if (index >= 0 && index < allItems.length) {
                    setSelectedId(allItems[index].id);
                    setActiveCategory(allItems[index].categoryId);
                }
            }, [allItems]);

            const nextItem = useCallback(() => {
                if (currentIndex < allItems.length - 1) navigateTo(currentIndex + 1);
            }, [currentIndex, navigateTo]);

            const prevItem = useCallback(() => {
                if (currentIndex > 0) navigateTo(currentIndex - 1);
            }, [currentIndex, navigateTo]);

            const handleCategoryClick = useCallback((catId) => {
                if (catId === activeCategory) return;
                if (view === 'landing') {
                    setSlideDirection('right');
                } else if (activeCategory) {
                    const currentIdx = CATEGORIES.findIndex(c => c.id === activeCategory);
                    const newIdx = CATEGORIES.findIndex(c => c.id === catId);
                    setSlideDirection(newIdx < currentIdx ? 'left' : 'right');
                    setExitingCategory(activeCategory);
                    setTimeout(() => setExitingCategory(null), 800);
                }
                setIframeLoaded(false);
                setActiveCategory(catId);
                setView('gallery');
                setSelectedId(null);
            }, [view, activeCategory]);

            const handleHomeClick = useCallback(() => {
                if (view === 'landing') return;
                setExitingCategory(activeCategory);
                setSlideDirection('left');
                setActiveCategory(null);
                setSelectedId(null);
                setIframeLoaded(false);
                setView('landing');
                setTimeout(() => setExitingCategory(null), 800);
            }, [view, activeCategory]);

            // --- Updated Touch Handling to allow scrolling ---
            const touchStartPos = useRef({ x: null, y: null });
            const handleTouchStart = (e) => {
                touchStartPos.current = {
                    x: e.touches[0].clientX,
                    y: e.touches[0].clientY
                };
            };

            const handleTouchEnd = (e) => {
                if (touchStartPos.current.x === null) return;

                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;

                const diffX = touchStartPos.current.x - touchEndX;
                const diffY = touchStartPos.current.y - touchEndY;

                // If vertical movement is significant, prioritize scrolling over swiping
                if (Math.abs(diffY) > Math.abs(diffX)) {
                    touchStartPos.current = { x: null, y: null };
                    return;
                }

                // Horizontal Swipe threshold
                if (Math.abs(diffX) > 60) {
                    if (selectedId) {
                        diffX > 0 ? nextItem() : prevItem();
                    } else if (view === 'landing') {
                        if (diffX > 0) handleCategoryClick(CATEGORIES[0].id);
                    } else if (view === 'gallery') {
                        const idx = CATEGORIES.findIndex(c => c.id === activeCategory);
                        let nextIdx = diffX > 0 ? idx + 1 : idx - 1;
                        if (nextIdx >= 0 && nextIdx < CATEGORIES.length) {
                            handleCategoryClick(CATEGORIES[nextIdx].id);
                        }
                    }
                }
                touchStartPos.current = { x: null, y: null };
            };

            useEffect(() => {
                const handleKey = (e) => {
                    if (!selectedId) return;
                    if (e.key === 'ArrowRight') nextItem();
                    if (e.key === 'ArrowLeft') prevItem();
                    if (e.key === 'Escape') setSelectedId(null);
                };
                window.addEventListener('keydown', handleKey);
                return () => window.removeEventListener('keydown', handleKey);
            }, [selectedId, nextItem, prevItem]);

            const renderGrid = (catId, animationClass, isExiting = false) => {
                if (!catId) return null;
                return (
                    <div
                        key={catId + (isExiting ? '-exit' : '-entry')}
                        className={`${isExiting ? 'absolute top-0 left-0 w-full' : 'relative'} ${animationClass}`}
                    >
                        <div className={`${catId === 'songs' ? 'block' : 'item-grid'} rounded-lg overflow-hidden`}>
                            {
                                (catId === 'songs') && (
                                    <>
                                        {!iframeLoaded && (
                                            <div className="spinner-overlay" data-testid="iframe-spinner">
                                                <div className="spinner" />
                                            </div>
                                        )}
                                        <iframe
                                            data-testid="embed-iframe"
                                            style={{ borderRadius: '12px', display: iframeLoaded ? 'block' : 'none' }}
                                            src="https://open.spotify.com/embed/playlist/2QorRWqR3d67omG6dGA6im?utm_source=generator&theme=0"
                                            width="100%"
                                            height="600"
                                            frameBorder="0"
                                            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                                            loading="eager"
                                            onLoad={() => setIframeLoaded(true)}
                                        ></iframe>
                                    </>
                                )
                            }
                            {INITIAL_DATA[catId].map((item) => (
                                <div key={item.id} className="grid-item cursor-pointer group" onClick={() => !isExiting && setSelectedId(item.id)}>
                                    <img src={item.image} alt={item.title} />
                                    <div className="grid-item-info">
                                        <h4 className="text-sm md:text-xl font-serif title-clamp">{item.title}</h4>
                                        <div className="flex gap-1 mt-2 items-center">
                                            {[...Array(5)].map((_, i) => {
                                                const fill = Math.max(0, Math.min(1, item.rating - i));
                                                return (
                                                    <div key={i} className="relative h-1 w-6 bg-white/10 rounded overflow-hidden">
                                                        <div className="absolute left-0 top-0 h-full bg-white" style={{ width: `${fill * 100}%` }} />
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            const renderReview = (reviewText) => {
                if (!reviewText) return null;

                // Split by double newline for paragraphs, single for list items
                const lines = reviewText.split(/\r?\n/);
                const elements = [];
                let currentList = [];

                lines.forEach((line, index) => {
                    const trimmedLine = line.trim();
                    if (!trimmedLine && currentList.length === 0) return;
                    if (trimmedLine.startsWith('•')) {
                        currentList.push(<li key={index}>{trimmedLine.substring(1).trim()}</li>);
                    } else {
                        if (currentList.length > 0) {
                            elements.push(<ul key={`list-${index}`}>{currentList}</ul>);
                            currentList = [];
                        }
                        if (trimmedLine) {
                            const isHeading = trimmedLine.includes('loved');
                            elements.push(
                                <p key={index} className={isHeading ? 'text-white font-medium uppercase tracking-widest text-[10px] mb-4 mt-8' : ''}>
                                    {trimmedLine}
                                </p>
                            );
                        }
                    }
                });
                if (currentList.length > 0) elements.push(<ul key="list-final">{currentList}</ul>);
                return <div className="review-content">{elements}</div>;
            };

            return (
                <div
                    className={`relative min-h-screen bg-black text-white ${selectedId ? '' : 'overflow-hidden'}`}
                    onTouchStart={handleTouchStart}
                    onTouchEnd={handleTouchEnd}
                >
                    <div className={`hero-bg ${view === 'gallery' || selectedId ? 'gallery scale-110 blur-md opacity-20' : ''}`} />

                    <header className={`fixed top-0 left-0 w-full p-6 md:p-12 z-[80] flex justify-between items-center transition-all duration-500 ${view === 'gallery' || selectedId ? 'bg-black/40 backdrop-blur-md' : 'bg-transparent'}`}>
                        <div className="flex items-center gap-4">
                            {(view === 'gallery' || selectedId) && (
                                <button onClick={handleHomeClick} className="p-2 opacity-60 hover:opacity-100 transition-opacity">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><path d="M19 12H5M12 19l-7-7 7-7" /></svg>
                                </button>
                            )}
                            <h1 className="text-[10px] md:text-sm font-medium tracking-[0.4em] uppercase opacity-40">Archive 2025</h1>
                        </div>
                        <h2 className="text-xl md:text-5xl font-serif italic tracking-tight">
                            {selectedId ? CATEGORIES.find(c => c.id === selectedItem?.categoryId)?.titleLabel : (activeCategory ? CATEGORIES.find(c => c.id === activeCategory).titleLabel : '')}
                        </h2>
                    </header>

                    {/* Content Views */}
                    {view === 'landing' && (
                        <div className="absolute inset-0 flex flex-col items-center justify-center p-8 fade-in">
                            <div className="text-center mb-24 max-w-2xl">
                                    <h1 className="text-8xl md:text-[12rem] font-serif leading-none tracking-tighter mb-8 landing-title">Best of 2025</h1>
                                    <p className="text-base md:text-xl font-light opacity-60 tracking-wide leading-relaxed px-4 landing-lead">
                                        An entirely unbiased anthology of the year's most impactful media. You are welcome.
                                    </p>
                                </div>
                        </div>
                    )}

                    {view === 'gallery' && !selectedId && (
                        <main className="min-h-screen p-20 md:pt-48 pb-32 relative z-10 max-w-[1600px] mx-auto px-4 md:px-12 overflow-y-auto no-scrollbar h-screen">
                            <div className="gallery-container">
                                {exitingCategory && renderGrid(exitingCategory, slideDirection === 'left' ? 'exit-to-right' : 'exit-to-left', true)}
                                {activeCategory && renderGrid(activeCategory, slideDirection === 'left' ? 'slide-from-left' : 'slide-from-right', false)}
                            </div>
                        </main>
                    )}

                    {/* Detail Modal */}
                    {selectedId && selectedItem && (
                        <div className="fixed inset-0 z-[100] bg-black overflow-y-auto no-scrollbar overscroll-contain">
                            {/* Cinematic Image Header - Now 50% height */}
                            <div className="relative w-full h-[50vh]">
                                <img src={selectedItem.image} className="w-full h-full object-cover" />
                                <div className="absolute inset-0 bg-gradient-to-b from-transparent via-black/10 via-[10%] via-black/40 via-[40%] to-black to-[90%]" />
                            </div>

                            {/* Detail Content */}
                            <div className="relative z-10 -mt-24 md:-mt-32 pb-48">
                                <div className="max-w-4xl mx-auto px-6 flex flex-col items-center text-center">
                                    <span className="inline-block text-[10px] uppercase tracking-[0.5em] text-white/40 mb-6 px-4 py-1.5 rounded-full border border-white/10 backdrop-blur-md">
                                        {selectedItem.year}
                                    </span>
                                    <h2 className="text-5xl md:text-8xl font-serif mb-8 tracking-tighter">
                                        {selectedItem.title}
                                    </h2>
                                    <div className="text-lg md:text-xl font-light text-white/70 leading-relaxed italic mb-16 max-w-2xl">
                                        {renderReview(selectedItem.review)}
                                    </div>

                                    {/* Favorite Quotes Section */}
                                    {selectedItem.quotes && selectedItem.quotes.length > 0 && (
                                        <div className="w-full max-w-2xl pt-16 border-t border-white/10 mb-16">
                                            <h3 className="text-[10px] uppercase tracking-[0.4em] text-white/30 mb-10">Favorite Quotes</h3>
                                            <div className="space-y-12">
                                                {selectedItem.quotes.map((quote, idx) => (
                                                    <blockquote key={idx} className="relative group text-left w-full">
                                                        <span className="absolute -left-4 -top-4 text-4xl font-serif text-white/5 pointer-events-none">"</span>
                                                        <p className="text-2xl md:text-3xl font-serif italic text-white/80 leading-snug">{quote}</p>
                                                    </blockquote>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    <a href={selectedItem.url} target="_blank" className="text-[10px] uppercase tracking-[0.3em] text-white/30 hover:text-white transition-all pb-1 border-b border-white/5 hover:border-white/40 mb-12">
                                        {selectedItem.site ? selectedItem.site : CATEGORIES.find(c => c.id === selectedItem.categoryId)?.brand}
                                    </a>
                                </div>
                            </div>

                            {/* FIXED Pagination Controls - Always Visible */}
                            <div className="fixed bottom-0 left-0 right-0 z-[120] pb-12 pt-16 bg-gradient-to-t from-black via-black/80 to-transparent pointer-events-none">
                                <div className="flex flex-col items-center justify-center gap-4 pointer-events-auto">
                                    <div className="flex items-center gap-6">
                                        <button onClick={prevItem} disabled={currentIndex === 0} className={`p-4 rounded-full border border-white/5 transition-all ${currentIndex === 0 ? 'opacity-10' : 'hover:bg-white/10 backdrop-blur-sm'}`}>
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M15 18l-6-6 6-6" /></svg>
                                        </button>
                                        <div className="flex gap-2">
                                            {allItems.map((_, i) => (
                                                <div key={i} className={`h-1 rounded-full transition-all duration-500 ${i === currentIndex ? 'w-8 bg-white' : 'w-2 bg-white/10'}`} />
                                            ))}
                                        </div>
                                        <button onClick={nextItem} disabled={currentIndex === allItems.length - 1} className={`p-4 rounded-full border border-white/5 transition-all ${currentIndex === allItems.length - 1 ? 'opacity-10' : 'hover:bg-white/10 backdrop-blur-sm'}`}>
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 18l6-6-6-6" /></svg>
                                        </button>
                                    </div>
                                    <p className="text-[9px] uppercase tracking-[0.2em] opacity-20">Browse through the collection</p>
                                </div>
                            </div>

                            <button onClick={() => setSelectedId(null)} className="fixed top-6 right-6 md:top-12 md:right-12 z-[130] p-3 rounded-full bg-black/20 hover:bg-black/40 backdrop-blur-md border border-white/10 transition-all">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 6L6 18M6 6l12 12" /></svg>
                            </button>
                        </div>
                    )}

                    {/* Navigation Pill - Hidden when Detail is open to avoid UI clash */}
                    {!selectedId && (
                        <div className="fixed bottom-8 left-0 right-0 flex justify-center z-[60] px-4 pointer-events-none">
                            <nav className="flex items-center gap-1 md:gap-2 nav-pill pointer-events-auto">
                                <button onClick={handleHomeClick} className={`flex items-center p-3 md:px-6 md:py-2.5 rounded-full transition-all duration-300 ${view === 'landing' ? 'bg-white text-black' : 'text-white/40 hover:text-white'}`}>
                                    <Icons.home />
                                    <span className="hidden md:inline text-[10px] font-medium uppercase tracking-[0.2em] ml-2">Home</span>
                                </button>
                                <div className="w-[1px] h-4 bg-white/10 mx-1" />
                                {CATEGORIES.map(cat => {
                                    const IconComp = Icons[cat.id];
                                    return (
                                        <button key={cat.id} onClick={() => handleCategoryClick(cat.id)} className={`flex items-center p-3 md:px-6 md:py-2.5 rounded-full transition-all duration-300 ${activeCategory === cat.id ? 'bg-white text-black' : 'text-white/40 hover:text-white'}`}>
                                            <span className="md:hidden"><IconComp /></span>
                                            <span className="hidden md:inline text-[10px] font-medium uppercase tracking-[0.2em]">{cat.label}</span>
                                        </button>
                                    );
                                })}
                            </nav>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>